<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Connexion — SUPCONTENT</title>
  <link rel="stylesheet" href="/styles.css" />
</head>

<body>
  <div class="nav">
    <div class="nav-inner">
      <div class="brand"><span class="dot"></span> SUPCONTENT Music</div>
      <div class="menu">
        <a class="pill" href="/index.html">Accueil</a>
        <a class="pill" href="/search.html">Recherche</a>
        <a class="pill" href="/auth.html" aria-current="page">Connexion</a>
        <a class="pill" href="/profile.html">Profil</a>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="grid">
      <div class="card span6">
        <h2>Créer un compte</h2>

        <!-- action=javascript:void(0) évite toute navigation même si JS crash -->
        <form id="registerForm" class="form" method="post" action="javascript:void(0)">
          <div class="two">
            <div>
              <label>Email</label>
              <input class="input" name="email" type="email" required placeholder="test@test.com" autocomplete="email" />
            </div>
            <div>
              <label>Nom affiché</label>
              <input class="input" name="displayName" required placeholder="Farouk" autocomplete="nickname" />
            </div>
          </div>

          <div>
            <label>Mot de passe (min 8)</label>
            <input class="input" name="password" type="password" minlength="8" required placeholder="Password123!" autocomplete="new-password" pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}" title="8+ caractères avec majuscule, minuscule, chiffre et caractère spécial." />
          </div>

          <button class="btn primary" type="submit">S'inscrire</button>
          <small>Après inscription, on stocke les tokens en localStorage. Mot de passe: 8+ caractères avec majuscule, minuscule, chiffre, spécial.</small>
        </form>
      </div>

      <div class="card span6">
        <h2>Se connecter</h2>

        <div class="row" style="margin-bottom:10px">
          <button id="githubLoginBtn" class="btn" type="button">Continuer avec GitHub</button>
        </div>

        <form id="loginForm" class="form" method="post" action="javascript:void(0)">
          <div>
            <label>Email</label>
            <input class="input" name="email" type="email" required autocomplete="email" />
          </div>

          <div>
            <label>Mot de passe</label>
            <input class="input" name="password" type="password" required autocomplete="current-password" />
          </div>

          <button class="btn primary" type="submit">Connexion</button>
        </form>

        <hr/>

        <div class="row">
          <button id="logoutBtn" class="btn danger" type="button">Déconnexion (local)</button>
          <a class="btn" href="/profile.html">Voir mon profil</a>
        </div>

        <small>
          La déconnexion invalide la session côté serveur puis efface les tokens côté navigateur.
        </small>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <!-- ✅ script séparé : tu verras maintenant GET /auth.js dans tes logs -->
  <script type="module" src="/auth.js"></script>
</body>
</html>
